# é”
## ä»€ä¹ˆæ˜¯é”

é”åœ¨JAVAä¸­æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œå°¤å…¶æ˜¯åœ¨å½“ä»Šçš„äº’è”ç½‘æ—¶ä»£ï¼Œé«˜å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œæ›´æ˜¯ç¦»ä¸å¼€é”ã€‚é‚£ä¹ˆé”åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ
åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œé”(lock)æˆ–äº’æ–¥(mutex)æ˜¯ä¸€ç§åŒæ­¥æœºåˆ¶ï¼Œç”¨äºåœ¨æœ‰è®¸å¤šæ‰§è¡Œçº¿ç¨‹çš„ç¯å¢ƒä¸­å¼ºåˆ¶å¯¹èµ„æºçš„è®¿é—®é™åˆ¶ã€‚
é”æ—¨åœ¨å¼ºåˆ¶å®æ–½äº’æ–¥æ’ä»–ã€å¹¶å‘æ§åˆ¶ç­–ç•¥ã€‚
å’±ä¸¾ä¸€ä¸ªç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼šå¤§å®¶éƒ½å»è¿‡è¶…å¸‚ä¹°ä¸œè¥¿ï¼Œå¦‚æœä½ éšèº«å¸¦äº†åŒ…å‘¢ï¼Œè¦æ”¾åˆ°å‚¨ç‰©æŸœé‡Œã€‚
å’±ä»¬æŠŠè¿™ä¸ªä¾‹å­å†æç«¯ä¸€ä¸‹ï¼Œå‡å¦‚æŸœå­åªæœ‰ä¸€ä¸ªï¼Œç°åœ¨åŒæ—¶æ¥äº†3ä¸ªäººAï¼ŒBï¼ŒCï¼Œéƒ½è¦å¾€è¿™ä¸ªæŸœå­é‡Œæ”¾ä¸œè¥¿ã€‚
è¿™ä¸ªåœºæ™¯å°±æ„é€ äº†ä¸€ä¸ªå¤šçº¿ç¨‹ï¼Œå¤šçº¿ç¨‹è‡ªç„¶ç¦»ä¸å¼€é”ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
![img.png](picture/img.png)

Aï¼ŒBï¼ŒCéƒ½è¦å¾€æŸœå­é‡Œæ”¾ä¸œè¥¿ï¼Œå¯æ˜¯æŸœå­åªèƒ½æ”¾ä¸€ä»¶ä¸œè¥¿ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å‘¢å°±å¼•å‡ºäº†é”çš„æ¦‚å¿µï¼Œ3ä¸ªäººä¸­è°æŠ¢åˆ°äº†æŸœå­çš„é”ï¼Œè°å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæŸœå­ï¼Œå…¶ä»–çš„äººåªèƒ½ç­‰å¾…ã€‚
æ¯”å¦‚ï¼šCæŠ¢åˆ°äº†é”ï¼ŒCå¯ä»¥ä½¿ç”¨è¿™ä¸ªæŸœå­ã€‚Aå’ŒBåªèƒ½ç­‰å¾…ï¼Œç­‰Cä½¿ç”¨å®Œäº†ï¼Œé‡Šæ”¾é”ä»¥åï¼ŒAå’ŒBå†äº‰æŠ¢é”ï¼Œè°æŠ¢åˆ°äº†ï¼Œå†ç»§ç»­ä½¿ç”¨æŸœå­ã€‚
ä»£ç æ¼”ç¤ºå¦‚ä¸‹ï¼š

```java
// åˆ›å»ºæŸœå­Cabinetç±»
public class Cabinet {
    // æŸœå­ä¸­å­˜å‚¨çš„æ•°å­—
    private int storeNumber;

    public int getStoreNumber() {
        return storeNumber;
    }

    public void setStoreNumber(int storeNumber) {
        this.storeNumber = storeNumber;
    }
}
```
```java
// åˆ›å»ºç”¨æˆ·UserInfoç±»
public class UserInfo {
    // æŸœå­
    private Cabinet cabinet;
    // å­˜å‚¨çš„æ•°å­—
    private int storeNumber;

    /**
     * @param cabinet è¦ä½¿ç”¨çš„æŸœå­
     * @param storeNumber è¦å­˜å‚¨çš„æ•°å­—
     */
    public UserInfo(Cabinet cabinet, int storeNumber) {
        this.cabinet = cabinet;
        this.storeNumber = storeNumber;
    }
    // ä½¿ç”¨æŸœå­
    public void useCabinet() {
        cabinet.setStoreNumber(storeNumber);
    }

    // å¯åŠ¨ç±»æ¨¡æ‹Ÿ3ä¸ªç”¨æˆ·ä½¿ç”¨æŸœå­çš„åœºæ™¯ï¼š
    public static void main(String[] args) {
        final Cabinet cabinet = new Cabinet();
        ExecutorService es = Executors.newFixedThreadPool(3);
        for (int i = 0; i < 3; i++) {
            final int storeNumber = i;
            es.execute(() -> {
                UserInfo users = new UserInfo(cabinet, storeNumber);
                synchronized (cabinet) {
                    users.useCabinet();
                    System.out.println("æˆ‘æ˜¯ç”¨æˆ·" + storeNumber + ",æˆ‘å­˜å‚¨çš„æ•°å­—æ˜¯ï¼š" + cabinet.getStoreNumber());
                }
            });
        }
        es.shutdown();
    }
}
```

## ä¹è§‚é” ä¸ æ‚²è§‚é”

ä¹è§‚é”ä¸æ‚²è§‚é”åº”è¯¥æ˜¯æ¯ä¸ªå¼€å‘äººå‘˜æœ€å…ˆæ¥è§¦çš„ä¸¤ç§é”ã€‚ ä½†æ˜¯ä¸æ˜¯åœ¨ JAVA ä¸­æ¥è§¦çš„ï¼Œè€Œæ˜¯åœ¨æ•°æ®åº“å½“ä¸­ã€‚
å½“æ—¶çš„åº”ç”¨åœºæ™¯ä¸»è¦æ˜¯
çš„æ—¶å€™ï¼Œæ›´æ–°æ•°æ®è¿™ä¸ªåœºæ™¯ä¹Ÿæ˜¯ä½¿ç”¨é”çš„éå¸¸ä¸»è¦çš„åœºæ™¯ä¹‹ä¸€ã€‚
æ›´æ–°æ•°æ®çš„ä¸»è¦æµç¨‹å¦‚ä¸‹ï¼š

## åˆ†å¸ƒå¼é”
### å¤šç§åˆ†å¸ƒå¼é”ğŸ”’çš„å®ç°æ–¹æ¡ˆï¼Œå¦‚ä½•é€‰æ‹©ï¼Ÿ

| æ–¹å¼        | ä¼˜ç‚¹          | ç¼ºç‚¹               |
|-----------|-------------|------------------|
| æ•°æ®åº“       | å®ç°ç®€å•ï¼Œæ˜“äºç†è§£   | å¯¹æ•°æ®åº“å‹åŠ›å¤§          |
| Redis     | æ˜“äºç†è§£        | è‡ªå·±å®ç°ï¼Œä¸æ”¯æŒé˜»å¡       |
| Zookeeper | æ”¯æŒé˜»å¡        | éœ€ç†è§£zookeeperï¼Œç¨‹åºå¤æ‚ |
| Curator   | æä¾›é”çš„æ–¹æ³•ï¼Œæ”¯æŒé˜»å¡ | ä¾èµ–zookeeperï¼Œå¼ºä¸€è‡´  |
| Redisson  | æä¾›é”çš„æ–¹æ³•ï¼Œæ”¯æŒé˜»å¡ |                  |

ä¸æ¨èè‡ªå·±ç¼–å†™çš„åˆ†å¸ƒå¼é”ï¼Œæ¨èä½¿ç”¨Redissonå’ŒCuratorå®ç°çš„åˆ†å¸ƒå¼é”